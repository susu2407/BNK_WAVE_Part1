<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>약관 등록</title>
    <link rel="stylesheet" th:href="@{/css/admin/common/commonCSS.css}">
    <link rel="stylesheet" th:href="@{/css/admin/card/register.css}">
    <link rel="stylesheet" th:href="@{/css/admin/config/register.css}">
    <script th:src="@{/js/admin/common/aside.js}"></script>
</head>
<div th:replace="~{admin/common/header :: header}"></div>
<div th:replace="~{admin/common/aside :: aside}"></div>
<body>
<main>
    <div class="main-container">
        <div th:replace="~{admin/common/mainHeader :: mainHeader}"></div>
        <div id="main-content">

            <form th:action="@{/admin/config/terms/register}" method="post" enctype="multipart/form-data">
                <div class="form-flex-wrapper">
                    <label>약관명</label>
                    <input type="text" name="title">
                </div>
                <div class="form-flex-wrapper">
                    <label>약관내용</label>
                    <input type="text" name="content">
                    <label>
                        필수여부 <input type="checkbox" name="isRequired" >
                    </label>
                </div>

                <br>
                <label>약관파일</label>
                <input type="file" name="pdfFile" id="termsFile" accept="application/pdf">  <!-- PDF 파일만 업로드 가능하게 제한 -->

                <button type="submit">제출</button>
            </form>
            <div id="preview">
                <p>파일 미리보기</p>
                <p id="fileName">파일명 : -</p>
                <p id="fileSize">크기 : -</p>
                <p id="fileType">형식 : -</p>

                <!-- 미리보기 버튼 -->
                <button id="previewBtn" style="display: none;">파일 미리보기</button>

            </div>
        </div>
    </div>
</main>
<div th:replace="~{admin/common/footer :: footer}"></div>
<script>
    document.getElementById("termsFile").addEventListener("change", function () {
        const file = this.files[0];
        if (!file) return;

        document.getElementById("fileName").textContent = "파일명 : " + file.name;
        document.getElementById("fileSize").textContent = "크기 : " + (file.size / 1024).toFixed(2) + " KB";
        document.getElementById("fileType").textContent = "형식 : " + file.type;

        // PDF 미리보기 설정
        if (file.type === "application/pdf") {
            const reader = new FileReader();
            reader.onload = function (e) {
                const previewBtn = document.getElementById("previewBtn");

                // 미리보기 버튼 보이기
                previewBtn.style.display = "inline-block";

                // 미리보기 버튼 클릭 시 새 창으로 PDF 띄우기
                previewBtn.onclick = function () {
                    // 새 창으로 PDF 파일 열기
                    const pdfWindow = window.open();
                    pdfWindow.document.write('<iframe width="100%" height="100%" src="' + e.target.result + '"></iframe>');
                };
            };
            reader.readAsDataURL(file);
        } else {
            alert("PDF 파일만 업로드 가능합니다.");
            document.getElementById("previewBtn").style.display = "none"; // 미리보기 버튼 숨기기
        }
    });
</script>
</body>
</html>